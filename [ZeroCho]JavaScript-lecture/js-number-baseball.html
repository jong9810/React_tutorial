<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>숫자야구</title>
</head>

<body>
  <!--input태그와 button태그를 같이 사용하는 경우 form 태그로 감싸주는 경우가 많다.-->
  <form id="form">
    <input type="text" id="input" />
    <button>확인</button>
  </form>
  <div id="logs"></div>
  <script>
    const $input = document.querySelector('#input');
    const $form = document.querySelector('#form');
    const $logs = document.querySelector('#logs');

    // 랜덤한 숫자 4개 추출하는 코드
    const numbers = [];
    for (let i = 0; i < 10; i++) {
      numbers.push(i);
    }
    const answer = [];
    for (let i = 0; i < 4; i++) {
      const index = Math.floor(Math.random() * numbers.length);
      answer.push(numbers[index]);
      numbers.splice(index, 1);
    }

    const tries = [];
    function checkInput(input) { // 입력한 값을 검사하는 함수
      if (input.length !== answer.length) { // 입력한 값이 정답의 길이와 같지 않으면
        return alert('숫자의 개수를 확인해주세요.');
      }
      if (new Set(input).size !== answer.length) { // 중복된 값이 있으면
        return alert('중복되지 않게 입력해주세요.');
      }
      if (tries.includes(input)) { // 이미 시도했던 값이면
        return alert('이미 시도한 값입니다.');
      }
      return true;
    }

    $form.addEventListener('submit', (event) => {
      event.preventDefault(); // 기본 동작 막기
      const value = $input.value;
      $input.value = '';
      $input.focus();
      if (!checkInput(value)) { // 입력값이 올바르지 않다면

        return;
      }
      // 입력값이 올바르다면
      if (answer.join('') === value) {
        $logs.textContent = '홈런!';
        return;
      }
      if (tries.length >= 9) {
        const message = document.createTextNode(`패배! 정답은 ${answer.join('')}`); // 패배 메시지 텍스트를 만들어준다.
        $logs.appendChild(message); // logs 태그에 추가해준다.
        return;
      }

      // 몇 스트라이크 몇 볼인지 검사
      let strike = 0;
      let ball = 0;
      for (let i = 0; i < answer.length; i++) {
        const index = value.indexOf(answer[i]);
        if (index > -1) { // 정답의 i번째 숫자와 일치하는 숫자가 value에 있다면
          if (index === i) { // 자릿수도 같다면
            strike += 1;
          } else { // 숫자만 같다면
            ball += 1;
          }
        }
      }
      $logs.append(`${value} : ${strike} 스트라이크 ${ball} 볼`, document.createElement('br'));
      tries.push(value);
    })

    // 프로그램의 오류는 배열이나 객체의 처음 or 끝에서 많이 발생하므로 
    // 극단적인 상황을 가정해보면 오류를 발견할 확률이 올라간다.

    // form태그 안의 버튼을 누르면 submit이 호출된다.
    // form의 기본동작은 웹이 새로고침되는 것이다.
    // event.target[0] : input 태그
    // event.target에 배열 인덱스로 접근하면 특정 태그를 선택하는 것도 가능하다.

    // new Set(input) : 중복된 값을 제거해준다.

    // 배열.join('') : 배열의 원소를 문자열로 만들어줌
    // 문자열.split('') : ''를 기준으로 문자열을 쪼개서 배열로 만들어줌
    // 태그.innerHTML : 문자열 안에 html 태그가 있으면 인식해서 적용시켜줌.
    // 태그.textContent : html태그를 문자열로 인식해서 그대로 찍어줌.
    // document.createElement('br') : br태그를 생성시켜줌
    // appendChild : 반드시 createTextNode로 텍스트를 만든 후에 그 값을 전달해주어야 한다. 여러 개 추가도 불가능. 잘 안 쓰임
    // append : appendChild의 단점을 보완한 메서드로, 여러개 추가가 가능하고 문자열인 경우에는 createTextNode로 생성하지 않아도 된다.

    // foreach문
  </script>
</body>

</html>